<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ú†Øªâ€ŒØ¨Ø§Øª Ù‡ÙˆØ´Ù…Ù†Ø¯ BK AI</title>
    <style>
        :root {
            --primary-color: #4a6fa5;
            --secondary-color: #6c757d;
            --background-color: #f8f9fa;
            --user-message-bg: #e3f2fd;
            --bot-message-bg: #f1f0f0;
            --font-family: "Vazirmatn", "Tanha", "Segoe UI", Tahoma, sans-serif;
            --text-color: #333;
            --border-color: #ddd;
        }

        .dark-mode {
            --primary-color: #5a7fb5;
            --secondary-color: #8b9cb0;
            --background-color: #1a1a1a;
            --user-message-bg: #2a4b7c;
            --bot-message-bg: #3a3a3a;
            --text-color: #f0f0f0;
            --border-color: #444;
        }
        
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }
        
        body {
            font-family: var(--font-family);
            background-color: var(--background-color);
            color: var(--text-color);
            height: 100vh;
            display: flex;
            flex-direction: column;
            transition: all 0.3s ease;
        }
        
        .header {
            background-color: var(--primary-color);
            color: white;
            padding: 1rem;
            text-align: center;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            position: relative;
        }
        
        .chat-container {
            flex: 1;
            overflow-y: auto;
            padding: 1rem;
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }
        
        .message {
            max-width: 80%;
            padding: 0.75rem;
            border-radius: 1rem;
            animation: fadeIn 0.3s ease;
            position: relative;
            border: 1px solid var(--border-color);
        }
        
        .user-message {
            align-self: flex-end;
            background-color: var(--user-message-bg);
            border-bottom-right-radius: 0.25rem;
        }
        
        .bot-message {
            align-self: flex-start;
            background-color: var(--bot-message-bg);
            border-bottom-left-radius: 0.25rem;
        }
        
        .message-time {
            font-size: 0.7rem;
            color: var(--secondary-color);
            margin-top: 0.25rem;
            text-align: right;
        }
        
        .input-container {
            display: flex;
            padding: 1rem;
            background-color: var(--bot-message-bg);
            border-top: 1px solid var(--border-color);
        }
        
        #userInput {
            flex: 1;
            padding: 0.75rem;
            border: 1px solid var(--border-color);
            border-radius: 1.5rem;
            font-family: var(--font-family);
            outline: none;
            background-color: var(--background-color);
            color: var(--text-color);
        }
        
        #sendBtn {
            margin-right: 0.5rem;
            padding: 0.75rem 1.5rem;
            background-color: var(--primary-color);
            color: white;
            border: none;
            border-radius: 1.5rem;
            cursor: pointer;
            transition: background-color 0.3s;
        }
        
        #sendBtn:hover {
            background-color: #3a5a80;
        }
        
        .typing-indicator {
            display: none;
            align-self: flex-start;
            background-color: var(--bot-message-bg);
            padding: 0.75rem;
            border-radius: 1rem;
            margin-bottom: 0.5rem;
        }
        
        .typing-dots {
            display: flex;
            gap: 0.25rem;
        }
        
        .typing-dot {
            width: 0.5rem;
            height: 0.5rem;
            background-color: var(--secondary-color);
            border-radius: 50%;
            animation: typingAnimation 1.4s infinite ease-in-out;
        }
        
        .typing-dot:nth-child(1) { animation-delay: 0s; }
        .typing-dot:nth-child(2) { animation-delay: 0.2s; }
        .typing-dot:nth-child(3) { animation-delay: 0.4s; }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        @keyframes typingAnimation {
            0%, 60%, 100% { transform: translateY(0); }
            30% { transform: translateY(-5px); }
        }

        .settings-btn {
            position: absolute;
            left: 1rem;
            top: 1rem;
            background: none;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
            color: white;
        }

        .theme-toggle {
            position: absolute;
            right: 1rem;
            top: 1rem;
            background: none;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
            color: white;
        }
    </style>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/rastikerdar/vazirmatn@v33.003/Vazirmatn-font-face.css">
</head>
<body>
    <div class="header">
        <button class="settings-btn">âš™ï¸</button>
        <button class="theme-toggle" id="themeToggle">ğŸŒ™</button>
        <h1>Ú†Øªâ€ŒØ¨Ø§Øª Ù‡ÙˆØ´Ù…Ù†Ø¯ BK AI</h1>
        <p>Ù‡ÙˆØ´ Ù…ØµÙ†ÙˆØ¹ÛŒ Ú©Ù‡ ÙˆØ§Ù‚Ø¹Ø§Ù‹ Ù…ÛŒâ€ŒÙÙ‡Ù…Ø¯!</p>
    </div>
    
    <div class="chat-container" id="chatContainer">
        <div class="message bot-message">
            Ø³Ù„Ø§Ù…! Ù…Ù† BK AI Ù‡Ø³ØªÙ…ØŒ ÛŒÚ© Ú†Øªâ€ŒØ¨Ø§Øª Ù‡ÙˆØ´Ù…Ù†Ø¯. Ú†Ø·ÙˆØ± Ù…ÛŒâ€ŒØªÙˆÙ†Ù… Ú©Ù…Ú©ØªÙˆÙ† Ú©Ù†Ù…ØŸ
            <div class="message-time">Ù‡Ù…ÛŒÙ† Ø§Ù„Ø§Ù†</div>
        </div>
    </div>
    
    <div class="typing-indicator" id="typingIndicator">
        <div class="typing-dots">
            <div class="typing-dot"></div>
            <div class="typing-dot"></div>
            <div class="typing-dot"></div>
        </div>
    </div>
    
    <div class="input-container">
        <input type="text" id="userInput" placeholder="Ù¾ÛŒØ§Ù… Ø®ÙˆØ¯ Ø±Ø§ Ø¨Ù†ÙˆÛŒØ³ÛŒØ¯..." autocomplete="off">
        <button id="sendBtn">Ø§Ø±Ø³Ø§Ù„</button>
    </div>

    <script>
        // ====== Ø³ÛŒØ³ØªÙ… Ø¯Ø±Ú© Ø²Ø¨Ø§Ù† Ø·Ø¨ÛŒØ¹ÛŒ Ø³Ø§Ø¯Ù‡ ======
        class SimpleNLP {
            constructor() {
                this.patterns = this.initializePatterns();
                this.context = {};
            }
            
            initializePatterns() {
                return [
                    // Ø§Ù„Ú¯ÙˆÙ‡Ø§ÛŒ Ø³Ù„Ø§Ù… Ùˆ Ø§Ø­ÙˆØ§Ù„Ù¾Ø±Ø³ÛŒ
                    {
                        pattern: /(Ø³Ù„Ø§Ù…|Ø¯Ø±ÙˆØ¯|Ù‡ÛŒ|ØµØ¨Ø­ Ø¨Ø®ÛŒØ±|Ø¹ØµØ± Ø¨Ø®ÛŒØ±|Ø´Ø¨ Ø¨Ø®ÛŒØ±)/i,
                        category: "greeting",
                        responses: [
                            "Ø³Ù„Ø§Ù…! Ú†Ø·ÙˆØ± Ù…ÛŒâ€ŒØªÙˆÙ†Ù… Ú©Ù…Ú© Ú©Ù†Ù…ØŸ",
                            "Ø¯Ø±ÙˆØ¯ Ø¨Ø± Ø´Ù…Ø§! Ø­Ø§Ù„ØªÙˆÙ† Ú†Ø·ÙˆØ±Ù‡ØŸ",
                            "Ø³Ù„Ø§Ù…! Ø®ÙˆØ´Ø­Ø§Ù„Ù… Ú©Ù‡ Ø¨Ø§Ù‡Ø§Øª ØµØ­Ø¨Øª Ù…ÛŒâ€ŒÚ©Ù†Ù….",
                            "Ù‡ÛŒ! Ú†Ù‡ Ø®Ø¨Ø±ØŸ Ú†Ø·ÙˆØ± Ù…ÛŒâ€ŒØªÙˆÙ†Ù… Ú©Ù…Ú©Øª Ú©Ù†Ù…ØŸ"
                        ]
                    },
                    // Ø§Ù„Ú¯ÙˆÙ‡Ø§ÛŒ ØªØ´Ú©Ø±
                    {
                        pattern: /(Ù…Ù…Ù†ÙˆÙ†|Ù…Ø±Ø³ÛŒ|ØªØ´Ú©Ø±|Ø¯Ø³Øª Ù…Ø±ÛŒØ²Ø§Ø¯|Ù…Ù…Ù†ÙˆÙ†Ù…|Ø¨Ø§ØªØ´Ú©Ø±)/i,
                        category: "thanks",
                        responses: [
                            "Ø®ÙˆØ§Ù‡Ø´ Ù…ÛŒâ€ŒÚ©Ù†Ù…!",
                            "Ù‚Ø§Ø¨Ù„ÛŒ Ù†Ø¯Ø§Ø´Øª!",
                            "Ø®ÙˆØ´Ø­Ø§Ù„Ù… Ú©Ù‡ ØªÙˆÙ†Ø³ØªÙ… Ú©Ù…Ú© Ú©Ù†Ù…!",
                            "Ù‡Ù…ÛŒØ´Ù‡ Ø¯Ø± Ø®Ø¯Ù…Øª Ø´Ù…Ø§ Ù‡Ø³ØªÙ…!"
                        ]
                    },
                    // Ø§Ù„Ú¯ÙˆÙ‡Ø§ÛŒ Ù¾Ø±Ø³Ø´ Ø¯Ø±Ø¨Ø§Ø±Ù‡ Ø®ÙˆØ¯ Ø±Ø¨Ø§Øª
                    {
                        pattern: /(ØªÙˆ Ú©ÛŒØ³ØªÛŒ|Ø§Ø³Ù… ØªÙˆ Ú†ÛŒÙ‡|ØªÙˆ Ú†ÛŒ Ù‡Ø³ØªÛŒ|ØªÙˆ Ú†ÛŒØ³Øª|ä½ æ˜¯è°|what are you|who are you)/i,
                        category: "about_bot",
                        responses: [
                            "Ù…Ù† BK AI Ù‡Ø³ØªÙ…ØŒ ÛŒÚ© Ú†Øªâ€ŒØ¨Ø§Øª Ù‡ÙˆØ´Ù…Ù†Ø¯ Ú©Ù‡ Ø¨Ø±Ø§ÛŒ Ú©Ù…Ú© Ø¨Ù‡ Ø´Ù…Ø§ Ø·Ø±Ø§Ø­ÛŒ Ø´Ø¯Ù‡â€ŒØ§Ù….",
                            "Ø§Ø³Ù… Ù…Ù† BK AI Ù‡Ø³Øª. Ù…Ù† ÛŒÚ© Ø¯Ø³ØªÛŒØ§Ø± Ù‡ÙˆØ´Ù…Ù†Ø¯Ù… Ú©Ù‡ Ù…ÛŒâ€ŒØªÙˆÙ†Ù… Ø¨Ø§Ù‡Ø§Øª ØµØ­Ø¨Øª Ú©Ù†Ù… Ùˆ Ú©Ù…Ú©Øª Ú©Ù†Ù….",
                            "Ù…Ù† ÛŒÚ© Ù‡ÙˆØ´ Ù…ØµÙ†ÙˆØ¹ÛŒ Ù‡Ø³ØªÙ… Ú©Ù‡ Ù…ÛŒâ€ŒØªÙˆÙ†Ù… Ø¨Ù‡ Ø³ÙˆØ§Ù„Ø§Øª Ø´Ù…Ø§ Ù¾Ø§Ø³Ø® Ø¨Ø¯Ù… Ùˆ Ø¨Ø§Ù‡Ø§Øª Ú¯ÙØªÚ¯Ùˆ Ú©Ù†Ù…."
                        ]
                    },
                    // Ø§Ù„Ú¯ÙˆÙ‡Ø§ÛŒ Ù¾Ø±Ø³Ø´ Ø¯Ø±Ø¨Ø§Ø±Ù‡ Ù†Ø§Ù… Ú©Ø§Ø±Ø¨Ø±
                    {
                        pattern: /(Ø§Ø³Ù…Ù…|Ù†Ø§Ù…Ù…|Ù…Ù† .+ Ù‡Ø³ØªÙ…|Ø§Ø³Ù… Ù…Ù†|my name is|I am)/i,
                        category: "user_name",
                        responses: [
                            "Ú†Ù‡ Ø§Ø³Ù… Ù‚Ø´Ù†Ú¯ÛŒ! Ø®ÙˆØ´Ø­Ø§Ù„Ù… Ú©Ù‡ Ø¨Ø§Ù‡Ø§Øª Ø¢Ø´Ù†Ø§ Ø´Ø¯Ù….",
                            "Ø§Ø³Ù… Ø®ÙˆØ¨ÛŒ Ø¯Ø§Ø±ÛŒ! Ø®ÙˆØ´ Ø§ÙˆÙ…Ø¯ÛŒ.",
                            "Ú†Ù‡ Ø§Ø³Ù… Ø²ÛŒØ¨Ø§ÛŒÛŒ! Ø®ÙˆØ´Ø­Ø§Ù„Ù… Ú©Ù‡ Ø¨Ø§Ù‡Ø§Øª ØµØ­Ø¨Øª Ù…ÛŒâ€ŒÚ©Ù†Ù…."
                        ],
                        extractor: (message) => {
                            const matches = message.match(/(Ø§Ø³Ù…Ù…|Ù†Ø§Ù…Ù…|Ù…Ù†) (.+) (Ù‡Ø³ØªÙ…|Ø§Ø³Øª|am|is)/i);
                            return matches ? matches[2] : null;
                        }
                    },
                    // Ø§Ù„Ú¯ÙˆÙ‡Ø§ÛŒ Ù¾Ø±Ø³Ø´ Ø¯Ø±Ø¨Ø§Ø±Ù‡ Ø²Ù…Ø§Ù†
                    {
                        pattern: /(Ø³Ø§Ø¹Øª Ú†Ù†Ø¯Ù‡|ÙˆÙ‚Øª Ú†Ù†Ø¯Ù‡|å‡ ç‚¹äº†|what time|what is the time)/i,
                        category: "time",
                        responses: [
                            "Ù‡Ù…ÛŒÙ† Ø§Ù„Ø§Ù† Ø³Ø§Ø¹Øª {{time}} Ù‡Ø³Øª.",
                            "Ø§Ù„Ø§Ù† Ø³Ø§Ø¹Øª {{time}} Ù‡Ø³Øª.",
                            "Ø³Ø§Ø¹Øª {{time}} Ù‡Ø³Øª."
                        ]
                    },
                    // Ø§Ù„Ú¯ÙˆÙ‡Ø§ÛŒ Ù¾Ø±Ø³Ø´ Ø¯Ø±Ø¨Ø§Ø±Ù‡ ØªØ§Ø±ÛŒØ®
                    {
                        pattern: /(Ø§Ù…Ø±ÙˆØ² Ú†Ù†Ø¯Ù…Ù‡|ØªØ§Ø±ÛŒØ® Ø§Ù…Ø±ÙˆØ²|ä»Šå¤©æ˜¯|what date|what is the date)/i,
                        category: "date",
                        responses: [
                            "Ø§Ù…Ø±ÙˆØ² {{date}} Ù‡Ø³Øª.",
                            "Ø§Ù„Ø§Ù† {{date}} Ù‡Ø³Øª.",
                            "ØªØ§Ø±ÛŒØ® Ø§Ù…Ø±ÙˆØ²: {{date}}"
                        ]
                    },
                    // Ø§Ù„Ú¯ÙˆÙ‡Ø§ÛŒ Ø®Ø¯Ø§Ø­Ø§ÙØ¸ÛŒ
                    {
                        pattern: /(Ø®Ø¯Ø§Ø­Ø§ÙØ¸|Ø¨Ø§ÛŒ|Ø®Ø¯Ø§Ù†Ú¯Ù‡Ø¯Ø§Ø±|bye|goodbye|see you)/i,
                        category: "goodbye",
                        responses: [
                            "Ø®Ø¯Ø§Ø­Ø§ÙØ¸! Ø§Ù…ÛŒØ¯ÙˆØ§Ø±Ù… Ø¨Ø§Ø²Ù… Ø¨Ø¨ÛŒÙ†Ù…Øª.",
                            "Ø¨Ø§ÛŒ! Ø±ÙˆØ² Ø®ÙˆØ¨ÛŒ Ø¯Ø§Ø´ØªÙ‡ Ø¨Ø§Ø´ÛŒ.",
                            "Ø®Ø¯Ø§Ù†Ú¯Ù‡Ø¯Ø§Ø±! Ù‡Ù…ÛŒØ´Ù‡ Ø³Ù„Ø§Ù…Øª Ø¨Ø§Ø´ÛŒ."
                        ]
                    },
                    // Ø§Ù„Ú¯ÙˆÙ‡Ø§ÛŒ Ø³ÙˆØ§Ù„Ø§Øª Ø¹Ù…ÙˆÙ…ÛŒ
                    {
                        pattern: /(Ú†Ø·ÙˆØ±|Ú†Ú¯ÙˆÙ†Ù‡|Ú†Ø±Ø§|Ú†ÛŒ|Ú†Ù‡|Ú©ÛŒ|Ú©Ø¬Ø§|Ú†Ù†Ø¯|how|why|what|when|where|which|who)/i,
                        category: "question",
                        responses: [
                            "Ø³ÙˆØ§Ù„ Ø¬Ø§Ù„Ø¨ÛŒ Ù¾Ø±Ø³ÛŒØ¯ÛŒ. ÙÚ©Ø± Ù…ÛŒâ€ŒÚ©Ù†Ù… Ø¬ÙˆØ§Ø¨Ø´ Ø§ÛŒÙ† Ø¨Ø§Ø´Ù‡ Ú©Ù‡...",
                            "Ø®Ø¨ØŒ Ø§ÛŒÙ† Ø¨Ø³ØªÚ¯ÛŒ Ø¨Ù‡ Ø¹ÙˆØ§Ù…Ù„ Ù…Ø®ØªÙ„ÙÛŒ Ø¯Ø§Ø±Ù‡...",
                            "Ø§Ø² Ø¯ÛŒØ¯Ú¯Ø§Ù‡ Ù…Ù†ØŒ Ù…ÛŒØ´Ù‡ Ø§ÛŒÙ†Ø·ÙˆØ±çœ‹å¾… Ú©Ø±Ø¯ Ú©Ù‡...",
                            "Ø¨Ù‡ Ù†Ø¸Ø± Ù…Ù†ØŒ Ø§ÛŒÙ† Ù…ÙˆØ¶ÙˆØ¹ Ø±Ùˆ Ù…ÛŒØ´Ù‡ Ø§Ø² Ú†Ù†Ø¯ Ø¬Ù†Ø¨Ù‡ Ù…Ø®ØªÙ„Ù Ø¨Ø±Ø±Ø³ÛŒ Ú©Ø±Ø¯..."
                        ]
                    },
                    // Ø§Ù„Ú¯ÙˆÙ‡Ø§ÛŒ Ø§Ø­Ø³Ø§Ø³Ø§Øª
                    {
                        pattern: /(Ø®ÙˆØ´Ø­Ø§Ù„Ù…|ØºÙ…Ú¯ÛŒÙ†Ù…|Ø¹ØµØ¨Ø§Ù†ÛŒÙ…|Ø®Ø³ØªÙ…|Ø§Ø³ØªØ±Ø³ Ø¯Ø§Ø±Ù…|Ù†Ø§Ø±Ø§Ø­ØªÙ…|Ù†Ú¯Ø±Ø§Ù†Ù…|happy|sad|angry|tired)/i,
                        category: "emotion",
                        responses: [
                            "Ù…ØªÙˆØ¬Ù‡ Ø§Ø­Ø³Ø§Ø³Øª Ù…ÛŒØ´Ù…. Ù…ÛŒâ€ŒØ®ÙˆØ§ÛŒ Ø¯Ø± Ù…ÙˆØ±Ø¯Ø´ Ø¨ÛŒØ´ØªØ± ØµØ­Ø¨Øª Ú©Ù†ÛŒÙ…ØŸ",
                            "Ø§Ø­Ø³Ø§Ø³Ø§ØªØª Ø±Ùˆ Ø¯Ø±Ú© Ù…ÛŒâ€ŒÚ©Ù†Ù…. Ø§Ú¯Ø± Ø¯ÙˆØ³Øª Ø¯Ø§Ø±ÛŒØŒ Ù…ÛŒâ€ŒØªÙˆÙ†ÛŒÙ… Ø¨ÛŒØ´ØªØ± Ø­Ø±Ù Ø¨Ø²Ù†ÛŒÙ….",
                            "Ù…Ù…Ù†ÙˆÙ† Ú©Ù‡ Ø§Ø­Ø³Ø§Ø³Ø§ØªØª Ø±Ùˆ Ø¨Ø§ Ù…Ù† Ø¯Ø± Ù…ÛŒØ§Ù† Ú¯Ø°Ø§Ø´ØªÛŒ. Ø¯ÙˆØ³Øª Ø¯Ø§Ø±ÛŒ Ø¨ÛŒØ´ØªØ± ØµØ­Ø¨Øª Ú©Ù†ÛŒÙ…ØŸ"
                        ]
                    }
                ];
            }
            
            understand(message) {
                const lowerMessage = message.toLowerCase();
                
                // Ø¨Ø±Ø±Ø³ÛŒ Ø§Ù„Ú¯ÙˆÙ‡Ø§
                for (const patternObj of this.patterns) {
                    if (patternObj.pattern.test(message)) {
                        const response = this.getResponse(patternObj, message);
                        return {
                            category: patternObj.category,
                            response: response,
                            extractedData: patternObj.extractor ? patternObj.extractor(message) : null
                        };
                    }
                }
                
                // Ø§Ú¯Ø± Ù‡ÛŒÚ† Ø§Ù„Ú¯ÙˆÛŒÛŒåŒ¹é… Ù†Ø´Ø¯
                return {
                    category: "unknown",
                    response: this.getDefaultResponse(message),
                    extractedData: null
                };
            }
            
            getResponse(patternObj, message) {
                const responses = patternObj.responses;
                const randomIndex = Math.floor(Math.random() * responses.length);
                let response = responses[randomIndex];
                
                // Ø¬Ø§ÛŒÚ¯Ø²ÛŒÙ†ÛŒ dynamic values
                if (patternObj.category === "time") {
                    const now = new Date();
                    const time = now.toLocaleTimeString('fa-IR');
                    response = response.replace("{{time}}", time);
                } else if (patternObj.category === "date") {
                    const now = new Date();
                    const date = now.toLocaleDateString('fa-IR');
                    response = response.replace("{{date}}", date);
                }
                
                return response;
            }
            
            getDefaultResponse(message) {
                const defaultResponses = [
                    "Ø¬Ø§Ù„Ø¨ Ø¨ÙˆØ¯! Ù…ÛŒâ€ŒØ®ÙˆØ§ÛŒ Ø¨ÛŒØ´ØªØ± Ø¯Ø± Ø§ÛŒÙ† Ù…ÙˆØ±Ø¯ ØµØ­Ø¨Øª Ú©Ù†ÛŒÙ…ØŸ",
                    "Ù…Ù†Ø¸ÙˆØ±Øª Ø±Ùˆ Ú©Ø§Ù…Ù„ Ù…ØªÙˆØ¬Ù‡ Ù†Ø´Ø¯Ù…ØŒ Ù…ÛŒØ´Ù‡ Ú©Ù…ÛŒ Ø¨ÛŒØ´ØªØ± ØªÙˆØ¶ÛŒØ­ Ø¨Ø¯ÛŒØŸ",
                    "Ø¯Ø±Ø¨Ø§Ø±Ù‡ Ø§ÛŒÙ† Ù…ÙˆØ¶ÙˆØ¹ Ù…Ø·Ù…Ø¦Ù† Ù†ÛŒØ³ØªÙ…ØŒ Ù…ÛŒØªÙˆÙ†ÛŒ ÛŒÙ‡ Ú©Ù… Ø¨ÛŒØ´ØªØ± ØªÙˆØ¶ÛŒØ­ Ø¨Ø¯ÛŒØŸ",
                    "Ø¬Ø§Ù„Ø¨ Ø§Ø³Øª! Ø¯ÙˆØ³Øª Ø¯Ø§Ø±ÛŒ Ø¨ÛŒØ´ØªØ± Ø¯Ø± Ø§ÛŒÙ† Ù…ÙˆØ±Ø¯ ØµØ­Ø¨Øª Ú©Ù†ÛŒÙ…ØŸ",
                    "Ù…ÛŒâ€ŒØªÙˆÙ†ÛŒ Ø³ÙˆØ§Ù„Øª Ø±Ùˆ Ø¨Ù‡ Ø´Ú©Ù„ Ø¯ÛŒÚ¯Ø±ÛŒ Ø¨Ù¾Ø±Ø³ÛŒØŸ Ø´Ø§ÛŒØ¯ Ø¨Ù‡ØªØ± Ø¨ØªÙˆÙ†Ù… Ú©Ù…Ú©Øª Ú©Ù†Ù…."
                ];
                
                return defaultResponses[Math.floor(Math.random() * defaultResponses.length)];
            }
        }

        // ====== Ù…Ø¯ÛŒØ±ÛŒØª Ú†Øªâ€ŒØ¨Ø§Øª ======
        class ChatManager {
            constructor() {
                this.nlp = new SimpleNLP();
                this.setupEventListeners();
                this.loadSettings();
            }
            
            setupEventListeners() {
                const sendBtn = document.getElementById('sendBtn');
                const userInput = document.getElementById('userInput');
                const themeToggle = document.getElementById('themeToggle');
                
                sendBtn.addEventListener('click', () => this.sendMessage());
                userInput.addEventListener('keypress', (e) => {
                    if (e.key === 'Enter') this.sendMessage();
                });
                
                themeToggle.addEventListener('click', () => this.toggleTheme());
            }
            
            sendMessage() {
                const userInput = document.getElementById('userInput');
                const message = userInput.value.trim();
                
                if (message === '') return;
                
                this.addMessage(message, 'user');
                userInput.value = '';
                
                this.showTypingIndicator();
                
                // Ù¾Ø±Ø¯Ø§Ø²Ø´ Ù¾ÛŒØ§Ù… Ø¨Ø§ ØªØ§Ø®ÛŒØ± Ø¨Ø±Ø§ÛŒ Ø·Ø¨ÛŒØ¹ÛŒâ€ŒØªØ± Ø´Ø¯Ù†
                setTimeout(() => {
                    this.hideTypingIndicator();
                    this.processMessage(message);
                }, 1000 + Math.random() * 1000);
            }
            
            processMessage(message) {
                const understanding = this.nlp.understand(message);
                
                // Ø§Ú¯Ø± Ù†Ø§Ù… Ú©Ø§Ø±Ø¨Ø± Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ø´Ø¯ØŒ Ø°Ø®ÛŒØ±Ù‡ Ú©Ù†ÛŒØ¯
                if (understanding.extractedData) {
                    this.userName = understanding.extractedData;
                }
                
                // Ø´Ø®ØµÛŒâ€ŒØ³Ø§Ø²ÛŒ Ù¾Ø§Ø³Ø® Ø¨Ø§ Ù†Ø§Ù… Ú©Ø§Ø±Ø¨Ø±
                let response = understanding.response;
                if (this.userName) {
                    response = response.replace(/ØªÙˆ/gi, this.userName);
                }
                
                this.addMessage(response, 'bot');
            }
            
            addMessage(text, type) {
                const chatContainer = document.getElementById('chatContainer');
                const messageDiv = document.createElement('div');
                
                messageDiv.classList.add('message', type === 'user' ? 'user-message' : 'bot-message');
                
                const messageText = document.createElement('div');
                messageText.textContent = text;
                messageDiv.appendChild(messageText);
                
                const messageTime = document.createElement('div');
                messageTime.classList.add('message-time');
                messageTime.textContent = new Date().toLocaleTimeString('fa-IR');
                messageDiv.appendChild(messageTime);
                
                chatContainer.appendChild(messageDiv);
                chatContainer.scrollTop = chatContainer.scrollHeight;
            }
            
            showTypingIndicator() {
                document.getElementById('typingIndicator').style.display = 'block';
            }
            
            hideTypingIndicator() {
                document.getElementById('typingIndicator').style.display = 'none';
            }
            
            toggleTheme() {
                document.body.classList.toggle('dark-mode');
                const themeToggle = document.getElementById('themeToggle');
                themeToggle.textContent = document.body.classList.contains('dark-mode') ? 'â˜€ï¸' : 'ğŸŒ™';
                
                // Ø°Ø®ÛŒØ±Ù‡ ØªÙ… Ø¯Ø± localStorage
                localStorage.setItem('theme', document.body.classList.contains('dark-mode') ? 'dark' : 'light');
            }
            
            loadSettings() {
                // Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ ØªÙ… Ø§Ø² localStorage
                const savedTheme = localStorage.getItem('theme');
                if (savedTheme === 'dark') {
                    document.body.classList.add('dark-mode');
                    document.getElementById('themeToggle').textContent = 'â˜€ï¸';
                }
            }
        }

        // Ø±Ø§Ù‡â€ŒØ§Ù†Ø¯Ø§Ø²ÛŒ Ú†Øªâ€ŒØ¨Ø§Øª Ù‡Ù†Ú¯Ø§Ù…ÛŒ Ú©Ù‡ ØµÙØ­Ù‡ Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ø´Ø¯
        document.addEventListener('DOMContentLoaded', () => {
            window.chatManager = new ChatManager();
        });
    </script>
</body>
</html>
